library(raster)
library(sp)
library(rgeos)
df=read.csv(file.choose())
amazonia=shapefile(file.choose())
colnames(df)
df_coord=df[,c('long','lat')]

spdf <- SpatialPointsDataFrame(df_coord, df,proj4string =
                                 CRS('+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0'))

plot(spdf,add=T)
plot(amazonia)
#gIntersection faz a intersecção dos polígonos
df_masked_amazonia=gIntersection(spdf,amazonia) 
plot(df_masked_amazonia)

#crop faz um rectangulo com o extent da amazonia à volta dos pontos
df_cropped_amazonia=crop(spdf,amazonia)
plot(df_cropped_amazonia)

df_final=cbind.data.frame(df_cropped_amazonia$Species,df_cropped_amazonia$long,df_cropped_amazonia$long)
colnames(df_final)=c('Species','long','lat')


